# Attendance-Assistant-Backend
Python backend for attendance assistant. 


# Collections in MongoDB

- Every collection must have a unique `_id` field generated by MongoDB.
- Some collections have circular dependencies, so upon adding a document to a collection, the document's ID must be added to the appropriate field in the dependent collection. *This has to be done very carefully.* 

## Specializations
This includes things like `Core`, `Cybersecurity`, `Ai-ML`, etc. Every school will by default have a `Core` specialization. It is specializations that will have panels. not schools.

```json
{
  "_id": "Specialization ID Generated by MongoDB",
  "name": "Specialization Name",
  "panels": ["Panel ID 1", "Panel ID 2"]
}
```

## Subjects
These are subjects that are taught to any panel. They are meant to be atomic. 
```json
{
    "_id": "Subject ID Generated by MongoDB",
    "name": "Subject Name",
    "subject_code": "Subject Code"
}
```

## Schools
These are schools, so they are broad classifications. They will have specializations. `Core` by default. Eg. School of Computer Science, School of Mechanical Engineering, etc. 
```json
{
  "_id": "School ID Generated by MongoDB",
  "name": "School Name",
  "specializations": ["Specialization ID 1", "Specialization ID 2"]
}
```

## Semesters
Every panel will have semesters. This is primarily to keep track of what subjects are taught to a panel in the current semester. And quite important to calculate attendance of a student. 
```json
{
  "_id": "Semester ID Generated by MongoDB",
  "semester_number": 1,
  "panel": "Panel ID",
  "specialization": "Specialization ID",
  "school": "School ID",
  "start_date": "2021-08-01",
  "end_date": "2021-12-31",
  "subjects": [
    "Subject ID 1",
    "Subject ID 2"
  ],
  "teachers": [
    "Teacher ID 1",
    "Teacher ID 2"
  ],
  "teacher_subjects": {
    "subject_id 1": "Teacher ID 1",
    "subject_id 2": "Teacher ID 2"
  }
}
```

## Panels
These are also very important. They will hold all the students in a particular panel. The semesters that are completed by this panel, and the current semester.
```json
{
  "_id": "Panel ID Generated by MongoDB",
  "panel_letter": "A",
  "school": "School ID",
  "specialization": "Specialization ID",
  "students": [
    "Student ID 1",
    "Student ID 2"
  ],
  "semesters": [
    "Semester ID 1",
    "Semester ID 2"
  ],
  "current_semester": "Semester ID"
}
```

## Students
Each student is stored here. Their attendance is calculated on the spot and not stored in the database.
```json
{
  "_id": "Student ID Generated by MongoDB",
  "name": "Student Name",
  "prn": "10322108888",
  "panel": "Panel ID",
  "panel_roll_no": 1,
  "faces": [
    "Face image url",
    "Face image url 2"
  ],
  "face_encoding": "Encoding ID"
}
```

## Encodings
These are the encodings of the students. They are stored in firebase and the link is stored here. This will be in firebase or s3. Each student will have one encoding file to store their face data. This will be retrieved during facial recognition of a student. This has to be very accessible, and secure. 
```json
{
    "_id": "Encoding ID Generated by MongoDB",
    "student": "Student ID",
    "encoding": "Encoding link of firebase",
    "number_of_faces": 10
}
```

## Teachers
This is not a very important collection, as teachers will not be authenticated using facial recognition. They will be authenticated using their email and password.
```json
{
  "_id": "Teacher ID Generated by MongoDB",
  "name": "Teacher Name",
  "email": "teacher.name@mitwpu.edu.in",
  "subjects": [
    "Subject ID 1",
    "Subject ID 2"
  ],
  "panels": [
    "Panel ID 1",
    "Panel ID 2"
  ]
}
```

## Rooms
Rooms present in all buildings. 
```json
{
    "_id": "Room ID Generated by MongoDB",
    "name": "Room Name"
}
```

## Buildings
This is not a very important collection, as teachers will not be authenticated using facial recognition. They will be authenticated using their email and password.
```json
{
    "_id": "Building ID Generated by MongoDB",
    "name": "Building Name",
    "rooms": [
        "Room ID 1",
        "Room ID 2"
    ]
}
```

## Classes
This is the most important collection. This will hold all the classes that are conducted. The students present and absent will be updated here. After each class is conducted, this collection is updated by adding a new entry with the present students. 
```json
{
  "_id": "Class ID Generated by MongoDB",
  "date": "2021-08-01",
  "start_time": "10:00",
  "end_time": "11:00",
  "subject": "Subject ID",
  "teacher": "Teacher ID",
  "panel": "Panel ID",
  "semester": "Semester ID",
  "room": "Room ID",
  "students_present": [
    "Student ID 1",
    "Student ID 2"
  ],
  "students_absent": [
    "Student ID 3",
    "Student ID 4"
  ]
}
```

## LectureImages
```json
{
    "_id": "Image ID Generated by MongoDB",
    "room": "Room ID",
    "image_link": "Image link of firebase",
    "date": "2021-08-01",
    "time": "10:50"
}
```

# Routes



# Adding Attendance

## /api/v1/add_attendance
### POST
#### Request
```json
{
  "room_id": "Room ID",
  "subject_id": "Subject ID",
  "teacher_id": "Teacher ID",
  "panel_id": "Panel ID",
  "start_time": "10:00",
  "end_time": "11:00"
}
```


# Adding Image

## /api/v1/add_image
### POST
#### Request
```json
{
  "room_id": "Room ID",
  "image": "image"
}
```
#### Response
```json
{
  "status": "success",
  "message": "Image added successfully"
}
```

# Adding Stuff to the Database

## /api/v1/add_specialization
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```

## /api/v1/add_school
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```

## /api/v1/add_panel
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```

## /api/v1/add_student
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```


## /api/v1/add_face_image
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```

## /api/v1/add_face_encoding
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```


## /api/v1/add_teacher
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```

## /api/v1/add_semester
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```

## /api/v1/add_subject
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```


# Getting Stuff from the Database

## /api/v1/get_students
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```


## /api/v1/get_teachers
### POST
#### Request
```json
{

}
```
#### Response
```json
{
  
}
```
